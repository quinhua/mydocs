## 1.正则表达式的概念

正则表达式是对字符串操作的一种逻辑公式，就是用事先定义好的一些特定字符、及这些特定字符的组合，组成一个“规则字符串”，这个“规则字符串”用来表达对字符串的一种过滤逻辑。用我们自己的话来说: **正则表达式用来校验字符串是否满足一定的规则的公式**

## 2.正则表达式的用途

* 模式验证: 检测某个字符串是否符合规则，例如检测手机号、身份证号等等是否符合规范
* 匹配读取:读取字符串中符合规则的内容
* 匹配替换:替换字符串中符合规则的内容

## 3.正则表达式的语法

* 对象形式：`var reg = new RegExp("正则表达式")`当正则表达式中有"/"那么就使用这种
  
      // 类似创建数组可以new Array()、创建对象可以使用new Object()
      var reg = new RegExp("a");
  
* 直接量形式：`var reg = /正则表达式/`一般使用这种声明方式
  
      // 类似创建数组时可以使用[]、创建对象可以使用{}
      var reg = /a/;
  

### 3.1正则表达式的组成

正则表达式本身也是一个字符串，它由两种字符组成：

* 普通字符，例如大、小写英文字母；数字等。
* 元字符：被系统赋予特殊含义的字符。例如：^表示以某个字符串开始，$表示以某个字符串结束

### 3.2字符集合

| 语法格式 | 示例  | 说明  |
| --- | --- | --- |
| [字符列表] | 正则表达式：[abc] 含义：目标字符串包含abc中的任何一个字符 目标字符串：plain 是否匹配：是 原因：plain中的“a”在列表“abc”中 | 目标字符串中任何一个字符出现在字符列表中就算匹配。 |
| [^字符列表] | [^abc] 含义：目标字符串包含abc以外的任何一个字符 目标字符串：plain 是否匹配：是 原因：plain中包含“p”、“l”、“i”、“n” | 匹配字符列表中未包含的任意字符。 |
| [字符范围] | 正则表达式：[a-z] 含义：所有小写英文字符组成的字符列表 正则表达式：[A-Z] 含义：所有大写英文字符组成的字符列表 | 匹配指定范围内的任意字符。 |

### 3.3元字符

在正则表达式中被赋予特殊含义的字符，不能被直接当做普通字符使用。如果要匹配元字符本身，需要对元字符进行转义，转义的方式是在元字符前面加上“\”，例如：\^

| 代码  | 说明  |
| --- | --- |
| .   | 匹配除换行字符以外的任意字符。 |
| \w  | 匹配字母或数字或下划线等价于[a-zA-Z0-9_] |
| \W  | 匹配任何非单词字符。等价于[^A-Za-z0-9_] |
| \s  | 匹配任意的空白符，包括空格、制表符、换页符等等。等价于[\f\n\r\t\v]。 |
| \S  | 匹配任何非空白字符。等价于[^\f\n\r\t\v]。 |
| \d  | 匹配数字。等价于[0-9]。 |
| \D  | 匹配一个非数字字符。等价于[^0-9] |
| \b  | 匹配单词的开始或结束 |
| ^   | 匹配字符串的开始，但在[]中使用表示取反 |
| $   | 匹配字符串的结束 |

### 3.4出现次数

| 代码  | 说明  |
| --- | --- |
| *   | 出现零次或多次 |
| +   | 出现一次或多次 |
| ?   | 出现零次或一次 |
| {n} | 出现n次 |
| {n,} | 出现n次或多次 |
| {n,m} | 出现n到m次 |

### 3.5正则表达式使用体验

##### ① 模式验证

**注意**：这里是使用**正则表达式对象**来**调用**方法。

    // 创建一个最简单的正则表达式对象
    var reg = /o/;
    // 创建一个字符串对象作为目标字符串
    var str = 'Hello World!';
    // 调用正则表达式对象的test()方法验证目标字符串是否满足我们指定的这个模式，返回结果true
    console.log("/o/.test('Hello World!')="+reg.test(str));

##### ② 匹配读取

**注意**：这里是使用**字符串对象**来**调用**方法。

    // 在目标字符串中查找匹配的字符，返回匹配结果组成的数组
    var resultArr = str.match(reg);
    // 数组长度为1
    console.log("resultArr.length="+resultArr.length);
    
    // 数组内容是o
    console.log("resultArr[0]="+resultArr[0]);

##### ③ 替换

**注意**：这里是使用**字符串对象**来**调用**方法。

    var newStr = str.replace(reg,'@');
    // 只有第一个o被替换了，说明我们这个正则表达式只能匹配第一个满足的字符串
    console.log("str.replace(reg)="+newStr);//Hell@ World!
    
    // 原字符串并没有变化，只是返回了一个新字符串
    console.log("str="+str);//str=Hello World!

##### ④ 全文查找

如果不使用g对正则表达式对象进行修饰，则使用正则表达式进行查找时，仅返回第一个匹配；使用g后，返回所有匹配。

    // 目标字符串
    var targetStr = 'Hello World!';
    
    // 没有使用全局匹配的正则表达式
    var reg = /[A-Z]/;
    // 获取全部匹配
    var resultArr = targetStr.match(reg);
    // 数组长度为1
    console.log("resultArr.length="+resultArr.length);
    
    // 遍历数组，发现只能得到'H'
    for(var i = 0; i < resultArr.length; i++){
        console.log("resultArr["+i+"]="+resultArr[i]);
    }

对比

    // 目标字符串
    var targetStr = 'Hello World!';
    
    // 使用了全局匹配的正则表达式
    var reg = /[A-Z]/g;
    // 获取全部匹配
    var resultArr = targetStr.match(reg);
    // 数组长度为2
    console.log("resultArr.length="+resultArr.length);
    
    // 遍历数组，发现可以获取到“H”和“W”
    for(var i = 0; i < resultArr.length; i++){
        console.log("resultArr["+i+"]="+resultArr[i]);
    }

##### ⑤ 忽略大小写

    //目标字符串
    var targetStr = 'Hello WORLD!';
    
    //没有使用忽略大小写的正则表达式
    var reg = /o/g;
    //获取全部匹配
    var resultArr = targetStr.match(reg);
    //数组长度为1
    console.log("resultArr.length="+resultArr.length);
    //遍历数组，仅得到'o'
    for(var i = 0; i < resultArr.length; i++){
        console.log("resultArr["+i+"]="+resultArr[i]);
    }

对比

    //目标字符串
    var targetStr = 'Hello WORLD!';
    
    //使用了忽略大小写的正则表达式
    var reg = /o/gi;
    //获取全部匹配
    var resultArr = targetStr.match(reg);
    //数组长度为2
    console.log("resultArr.length="+resultArr.length);
    //遍历数组，得到'o'和'O'
    for(var i = 0; i < resultArr.length; i++){
        console.log("resultArr["+i+"]="+resultArr[i]);
    }

##### ⑥ 元字符使用

    var str01 = 'I love Java';
    var str02 = 'Java love me';
    // 匹配以Java开头
    var reg = /^Java/g;
    console.log('reg.test(str01)='+reg.test(str01)); // flase
    console.log("<br />");
    console.log('reg.test(str02)='+reg.test(str02)); // true
    
    var str01 = 'I love Java';
    var str02 = 'Java love me';
    // 匹配以Java结尾
    var reg = /Java$/g;
    console.log('reg.test(str01)='+reg.test(str01)); // true
    console.log("<br />");
    console.log('reg.test(str02)='+reg.test(str02)); // flase

##### ⑦ 字符集合的使用

    //n位数字的正则
    var targetStr="123456789";
    var reg=/^[0-9]{0,}$/;
    //或者 ： var reg=/^\d*$/;
    var b = reg.test(targetStr);//true
    
    //数字+字母+下划线，6-16位
    var targetStr="HelloWorld";
    var reg=/^[a-z0-9A-Z_]{6,16}$/;
    var b = reg.test(targetStr);//true

## 4.常用正则表达式
### 一、校验数字的表达式
```c
数字: ^[0-9]*$
n位的数字：^\d{n}$
至少n位的数字：^\d{n,}$
m-n位的数字：^\d{m,n}$
零和非零开头的数字：^(0|[1-9][0-9]*)$
非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(\.[0-9]{1,2})?$
带1-2位小数的正数或负数：^(\-)?\d+(\.\d{1,2})$
正数、负数、和小数：^(\-|\+)?\d+(\.\d+)?$
有两位小数的正实数：^[0-9]+(\.[0-9]{2})?$
有1~3位小数的正实数：^[0-9]+(\.[0-9]{1,3})?$
非零的正整数：^[1-9]\d*$ 或 ^([1-9][0-9]*){1,3}$ 或 ^\+?[1-9][0-9]*$
非零的负整数：^\-[1-9][]0-9"*$ 或 ^-[1-9]\d*$
非负整数：^\d+$ 或 ^[1-9]\d*|0$
非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$
非负浮点数：^\d+(\.\d+)?$ 或 ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$
非正浮点数：^((-\d+(\.\d+)?)|(0+(\.0+)?))$ 
或 ^(-([1-9]\d*\.\d*|0\.\d*[1-9]\d*))|0?\.0+|0$
正浮点数：^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$ 
或 ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$
负浮点数：^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$ 或 ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$
浮点数：^(-?\d+)(\.\d+)?$ 或 ^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$
```
### 二、校验字符的表达式
```c
汉字：^[\u4e00-\u9fa5]{0,}$
英文和数字：^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]{4,40}$
长度为3-20的所有字符：^.{3,20}$
由26个英文字母组成的字符串：^[A-Za-z]+$
由26个大写英文字母组成的字符串：^[A-Z]+$
由26个小写英文字母组成的字符串：^[a-z]+$
由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$
由数字、26个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w{3,20}$
中文、英文、数字包括下划线：^[\u4E00-\u9FA5A-Za-z0-9_]+$
中文、英文、数字但不包括下划线等符号：^[\u4E00-\u9FA5A-Za-z0-9]+$ 或 ^[\u4E00-\u9FA5A-Za-z0-9]{2,20}$
可以输入含有^%&',;=?$\"等字符：[^%&',;=?$\x22]+
禁止输入含有~的字符：[^~]+
```
### 三、特殊需求表达式
```c
Email地址：^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$
域名：[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?
InternetURL：[a-zA-z]+://[^\s]* 或 ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&=]*)?$
手机号码：^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$
身份证号(15位、18位数字)，最后一位是校验位，可能为数字或字符X：(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)
帐号是否合法(字母开头，允许8-16字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]{7,15}$
密码(以字母开头，长度在8~16之间，只能包含字母、数字和下划线)：^[a-zA-Z]\w{7,15}$
强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在 8-16 之间)：^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])[a-zA-Z0-9]{8,16}$
强密码(必须包含大小写字母和数字的组合，可以使用特殊字符，长度在8-16之间)：^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,16}$
日期格式：^\d{4}-\d{1,2}-\d{1,2}
一年的12个月(01～09和1～12)：^(0?[1-9]|1[0-2])$
一个月的31天(01～09和1～31)：^((0?[1-9])|((1|2)[0-9])|30|31)$
xml文件：^([a-zA-Z]+-?)+[a-zA-Z0-9]+\\.[x|X][m|M][l|L]$
中文字符的正则表达式：[\u4e00-\u9fa5]
双字节字符：[^\x00-\xff] (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计2，ASCII字符计1))
空白行的正则表达式：\n\s*\r (可以用来删除空白行)
HTML标记的正则表达式：<(\S*?)[^>]*>.*?|<.*? /> ( 首尾空白字符的正则表达式：^\s*|\s*$或(^\s*)|(\s*$) (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)
腾讯QQ号：[1-9][0-9]{4,} (腾讯QQ号从10000开始)
中国邮政编码：[1-9]\d{5}(?!\d) (中国邮政编码为6位数字)
IPv4地址：((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}
```

## 5.校验方法

```javascript
                /**
                 * @param {string} reg 正则表达式
                 * @param {string} value 待验证数据
                 * @param {function} callback 回调函数 
                 * @return {boolean,null} true or false or null
                 * */
                const verification = (reg, value, callback) => {
                    if (value == '' || value == undefined || value == null) {
                        callback(null);
                    } else {
                        if ((!reg.test(value))) {
                            callback(false);
                        } else {
                            callback(true);
                        }
                    }
                }
                
                verification(/^[\u4e00-\u9fa5]{2,4}$/,"张三",(res)=>{
                    console.log(res);
                    ...
                })
```



